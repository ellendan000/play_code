sourceSets {
    apiTest {
        compileClasspath += sourceSets.main.output
        runtimeClasspath += sourceSets.main.output
    }
}

configurations {
    apiTestImplementation.extendsFrom testImplementation
}

task apiTest(type: Test) {
    description = 'Runs api tests.'
    group = 'tests'

    testClassesDirs = sourceSets.apiTest.output.classesDirs
    classpath = sourceSets.apiTest.runtimeClasspath

    useJUnitPlatform()
    shouldRunAfter integTest, unitTest
}

test {
    exclude 'top/bujiaban/test/contracts/**/*'
}
check.dependsOn apiTest